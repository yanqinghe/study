<html>

<head>
<title>我的第一个 HTML 页面</title>
<script>
    var n=2;//粒子的个数
    //目标函数大小
    var x=[];//空间x坐标
    var y=[];//空间y坐标
    var v =[];//空间速度
    var c1=c2=2;
    var pbest=[];//个体历史最优位置
    var gbest=0;//全体最优位置
    var vMax=0.1;//
    function fitnessFunction(){
        for(var i=0;i<n;i++){
            y[i]=-1*x[i]*(x[i]-2);
        }
	}

	function init(){
        //随机生成初始化位置
        x[0]=-0.5;
        x[1]=2.6;
        v[0]=0.01;
        v[1]=0.02;
        fitnessFunction();
        //初始化当前个体极值，并找到群体极值
        for(var i=0;i<n;i++){
            pbest[i]=y[i];
            if(y[i]>gbest){
                gbest=y[i];
            }
            console.log("start gbest:" + gbest);
        }
    }

    function getMax(a,b){
	    return a>b?a:b;
    }

    //粒子群算法
    function PSO(max){
        for(var i=0;i<max;i++){
            var w=0.4;
            for(var j=0;j<n;j++){
                //更新位置和速度
                v[j]=w*v[j]+c1*Math.random()*(pbest[j]-x[j])+c2*Math.random()*(gbest-x[j]);
                if(v[j]>vMax){
                    v[j]=vMax;
                }
                x[j]+=v[j];
                //越界判断
                if(x[j]>2){
                    x[j]=2;
                }
                if(x[j]<-2){
                    x[j]=-2;
                }
                fitnessFunction();
                //更新个体极值和群体极值
                for (var h =0;h<n;h++){
                    pbest[h]=getMax(y[h],pbest[h]);
                    if (pbest[h]>gbest){
                        gbest=pbest[h];
                    }
                    console.log(x[h]+"    "+v[h]);
                }
                console.log("========"+(i+1)+"======gbest:"+gbest);
            }
        }
    }
    function main() {
        init();
        PSO(1000);
    }
</script>
</head>

<body>
<p>body 元素的内容会显示在浏览器中。</p>
<p>title 元素的内容会显示在浏览器的标题栏中。</p>
<button onclick="main()">开始运行</button>
</body>

</html>

